{
  "db_name": "PostgreSQL",
  "query": "\n            SELECT \n                cs.id,\n                cs.title,\n                cs.preview_text,\n                cs.source_document_count,\n                cs.analysis_status,\n                cs.is_active,\n                cs.created_at,\n                cs.updated_at,\n                COALESCE(hc_data.highlighted_contexts, '[]'::json) as highlighted_contexts,\n                COALESCE(cm_data.messages, '[]'::json) as messages\n            FROM chat_sessions cs\n            LEFT JOIN (\n                SELECT \n                    chat_session_id,\n                    json_agg(\n                        json_build_object(\n                            'id', id,\n                            'documentId', document_id,\n                            'documentTitle', document_title,\n                            'pageNumber', page_number,\n                            'selectedText', selected_text,\n                            'textCoordinates', text_coordinates,\n                            'createdAt', created_at\n                        ) ORDER BY created_at\n                    ) as highlighted_contexts\n                FROM highlighted_contexts\n                WHERE chat_session_id = $1\n                GROUP BY chat_session_id\n            ) hc_data ON cs.id = hc_data.chat_session_id\n            LEFT JOIN (\n                SELECT \n                    chat_session_id,\n                    json_agg(\n                        json_build_object(\n                            'id', id,\n                            'content', content,\n                            'senderType', sender_type,\n                            'createdAt', created_at,\n                            'metadata', metadata\n                        ) ORDER BY created_at\n                    ) as messages\n                FROM chat_messages\n                WHERE chat_session_id = $1\n                GROUP BY chat_session_id\n            ) cm_data ON cs.id = cm_data.chat_session_id\n            WHERE cs.id = $1\n            ",
  "describe": {
    "columns": [
      {
        "ordinal": 0,
        "name": "id",
        "type_info": "Uuid"
      },
      {
        "ordinal": 1,
        "name": "title",
        "type_info": "Varchar"
      },
      {
        "ordinal": 2,
        "name": "preview_text",
        "type_info": "Text"
      },
      {
        "ordinal": 3,
        "name": "source_document_count",
        "type_info": "Int4"
      },
      {
        "ordinal": 4,
        "name": "analysis_status",
        "type_info": "Varchar"
      },
      {
        "ordinal": 5,
        "name": "is_active",
        "type_info": "Bool"
      },
      {
        "ordinal": 6,
        "name": "created_at",
        "type_info": "Timestamptz"
      },
      {
        "ordinal": 7,
        "name": "updated_at",
        "type_info": "Timestamptz"
      },
      {
        "ordinal": 8,
        "name": "highlighted_contexts",
        "type_info": "Json"
      },
      {
        "ordinal": 9,
        "name": "messages",
        "type_info": "Json"
      }
    ],
    "parameters": {
      "Left": [
        "Uuid"
      ]
    },
    "nullable": [
      false,
      false,
      true,
      false,
      false,
      false,
      false,
      false,
      null,
      null
    ]
  },
  "hash": "c4f025bbe39b14d2ec415d54f1d481e00dedcc9e6b7174fbc6befa169a558d45"
}
